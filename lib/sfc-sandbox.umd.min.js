!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue"),require("@codemirror/basic-setup"),require("@codemirror/lang-html"),require("@vue/compiler-sfc"),require("@vue/compiler-sfc/dist/compiler-sfc.esm-browser")):"function"==typeof define&&define.amd?define(["exports","vue","@codemirror/basic-setup","@codemirror/lang-html","@vue/compiler-sfc","@vue/compiler-sfc/dist/compiler-sfc.esm-browser"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["sfc-sandbox"]={},t.Vue,t.CodeMirror,t.CodeMirrorLangHtml,t.CompilerSfc,t.CompilerSfcEsm)}(this,(function(t,e,n,r,o,s){"use strict";function a(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var i=a(s),l=e.defineComponent({name:"SplitPane",setup(t,{emit:n}){const r=e.ref(),o=e.reactive({dragging:!1,split:50,isHorizontal:!0});function s(){const{split:t}=o;return t<20?20:t>80?80:t}let a=0,i=0,l=0;const c=()=>{const t=r.value.offsetWidth;o.isHorizontal=t>720},d=e.computed((()=>({"flex-direction":o.isHorizontal?"row":"column"}))),p=e.computed((()=>o.isHorizontal?{width:s()+"%",borderRight:"1px solid #ebebeb"}:{height:s()+"%",borderBottom:"1px solid #ebebeb"})),u=e.computed((()=>o.isHorizontal?{width:100-s()+"%"}:{height:100-s()+"%"})),f=e.computed((()=>o.isHorizontal?{top:0,bottom:0,right:"-5px",width:"10px",cursor:"ew-resize"}:{left:0,right:0,bottom:"-5px",height:"10px",cursor:"ns-resize"}));return e.onMounted((()=>{window.addEventListener("resize",c,!1),c()})),e.onUnmounted((()=>{window.removeEventListener("resize",c,!1)})),{container:r,dragStart:function(t){o.dragging=!0,a=t.pageX,i=t.pageY,l=s()},dragMove:function(t){if(o.dragging){const e=r.value.offsetWidth,c=(o.isHorizontal?t.pageX:t.pageY)-(o.isHorizontal?a:i);o.split=l+~~(c/e*100),n("resize",[{size:s()},{size:100-s()}])}},dragEnd:function(){o.dragging&&(o.dragging=!1,n("resized",[{size:s()},{size:100-s()}]))},boundSplit:s,splitPaneStyle:d,leftStyle:p,rightStyle:u,draggerStyle:f,...e.toRefs(o)}}});const c=e.withScopeId("data-v-9241e4e6")(((t,n,r,o,s,a)=>(e.openBlock(),e.createBlock("div",{ref:"container",class:["split-pane",{dragging:t.dragging,"is-vertical":!t.isHorizontal}],style:t.splitPaneStyle,onMousemove:n[2]||(n[2]=(...e)=>t.dragMove&&t.dragMove(...e)),onMouseup:n[3]||(n[3]=(...e)=>t.dragEnd&&t.dragEnd(...e)),onMouseleave:n[4]||(n[4]=e=>t.dragging=!1)},[e.createVNode("div",{class:"split-pane__left",style:t.leftStyle},[e.renderSlot(t.$slots,"left"),e.createVNode("div",{class:"dragger",style:t.draggerStyle,onMousedown:n[1]||(n[1]=e.withModifiers(((...e)=>t.dragStart&&t.dragStart(...e)),["prevent"]))},null,36)],4),e.createVNode("div",{class:"split-pane__right",style:t.rightStyle},[e.renderSlot(t.$slots,"right")],4)],38))));function d(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}d(".split-pane[data-v-9241e4e6]{display:flex;height:100%}.split-pane.dragging[data-v-9241e4e6]{cursor:ew-resize}.split-pane.dragging.is-vertical[data-v-9241e4e6]{cursor:ns-resize}.dragging .split-pane__left[data-v-9241e4e6],.dragging .split-pane__right[data-v-9241e4e6]{pointer-events:none}.split-pane__left[data-v-9241e4e6],.split-pane__right[data-v-9241e4e6]{position:relative;height:100%}.dragger[data-v-9241e4e6]{position:absolute;z-index:99}"),l.render=c,l.__scopeId="data-v-9241e4e6",l.__file="packages/components/SplitPane.vue";const p=(t,e=166)=>{let n;return(...r)=>{n&&clearTimeout(n),n=setTimeout((()=>{t(...r)}),e)}};var u=e.defineComponent({name:"Codemirror",props:["modelValue"],setup(t,{emit:o}){const{modelValue:s}=e.toRefs(t),a=e.reactive({el:null,doc:s.value,view:null});return e.onMounted((()=>{const t=n.EditorState.create({doc:a.doc,extensions:[n.basicSetup,r.html(),n.EditorView.updateListener.of(p((({state:t})=>{a.doc=t.doc.toString(),o("update:modelValue",a.doc)})))]});a.view=new n.EditorView({state:t,parent:a.el})})),{...e.toRefs(a)}}});const f=e.withScopeId("data-v-0b029634");e.pushScopeId("data-v-0b029634");const m={class:"codemirror-container",ref:"el"};e.popScopeId();const g=f(((t,n,r,o,s,a)=>(e.openBlock(),e.createBlock("div",m,null,512))));d('@import "./index.css";.codemirror-container[data-v-0b029634]{height:100%;overflow-y:auto}'),u.render=g,u.__scopeId="data-v-0b029634",u.__file="packages/components/codemirror/index.vue";const _=["bigInt","optionalChaining","nullishCoalescingOperator"];"production"===process.env.NODE_ENV||Object.freeze({}),"production"===process.env.NODE_ENV||Object.freeze([]);const v="__sfc__";let h=i;async function b({filename:t,code:e,compiled:n}){if(!e.trim())return void(n.errors=[]);if(!t.endsWith(".vue"))return n.js=n.ssr=e,void(n.errors=[]);const r=Buffer.from(t).toString("base64"),{errors:o,descriptor:s}=h.parse(e,{filename:t,sourceMap:!0});if(o.length)return void(n.errors=o);if(s.script&&s.script.lang||s.scriptSetup&&s.scriptSetup.lang||s.styles.some((t=>t.lang))||s.template&&s.template.lang)return void(n.errors=['lang="x" pre-processors are not supported in the in-browser playground.']);const a=s.styles.some((t=>t.scoped));let i="",l="";const c=t=>{i+=t,l+=t},d=y(s,r,!1);if(!d)return;const[p,u]=d;if(i+=p,s.scriptSetup){const t=y(s,r,!0);if(!t)return;l+=t[0]}else l+=p;if(s.template&&!s.scriptSetup){const t=w(s,r,u,!1);if(!t)return;i+=t;const e=w(s,r,u,!0);if(!e)return;l+=e}a&&c(`\n__sfc__.__scopeId = ${JSON.stringify(`data-v-${r}`)}`),(i||l)&&(c(`\n__sfc__.__file = ${JSON.stringify(t)}\nexport default __sfc__`),n.js=i.trimStart(),n.ssr=l.trimStart());let f="";for(const e of s.styles){if(e.module)return void(n.errors=["<style module> is not supported in the playground."]);const o=await h.compileStyleAsync({source:e.content,filename:t,id:r,scoped:e.scoped,modules:!!e.module});o.errors.length?o.errors[0].message.includes("pathToFileURL")||(n.errors=o.errors):f+=o.code+"\n"}n.css=f?f.trim():"/* No <style> tags present */",n.errors=[]}function y(t,e,n){if(!t.script&&!t.scriptSetup)return["\nconst __sfc__ = {}",void 0];try{const r=h.compileScript(t,{id:e,refSugar:!0,inlineTemplate:!0,templateOptions:{ssr:n,ssrCssVars:t.cssVars}});let o="";return r.bindings&&(o+=`\n/* Analyzed bindings: ${JSON.stringify(r.bindings,null,2)} */`),o+="\n"+h.rewriteDefault(r.content,v),[o,r.bindings]}catch(t){return void P([t])}}function w(t,e,n,r){const o=h.compileTemplate({source:t.template.content,filename:t.filename,id:e,scoped:t.styles.some((t=>t.scoped)),slotted:t.slotted,ssr:r,ssrCssVars:t.cssVars,isProd:!1,compilerOptions:{bindingMetadata:n}});if(o.errors.length)return void P(o.errors);const s=r?"ssrRender":"render";return`\n${o.code.replace(/\nexport (function|const) (render|ssrRender)/,`$1 ${s}`)}\n__sfc__.${s} = ${s}`}const x="App.vue",k="main.js",S=t=>`import { createApp as _createApp } from "vue"\n\nif (window.__app__) {\n  window.__app__.unmount()\n  document.getElementById('app').innerHTML = ''\n}\n\ndocument.getElementById('__sfc-styles').innerHTML = window.__css__\nconst app = window.__app__ = _createApp(__modules__["${t}"].default)\napp.config.errorHandler = e => console.error(e)\napp.mount('#app')\n`.trim(),E="<template>\n  <h1>{{ msg }}</h1>\n</template>\n\n<script setup>\nconst msg = 'Hello World!'\n<\/script>\n".trim(),M=S(x),C='\n{\n  "imports": {\n  }\n}'.trim();class j{constructor(t,e=""){this.compiled={js:"",css:"",ssr:"",errors:[""]},this.filename=t,this.code=e}}let N={};N={[x]:new j(x,E),[k]:new j(k,M)};const $=e.reactive({files:N,activeFilename:x,get activeFile(){return $.files[$.activeFilename]},get importMap(){const t=$.files["import-map.json"];return t&&t.code},errors:[]});e.watchEffect((()=>b($.activeFile)));const V=e.computed((()=>$.activeFilename)),O=e.computed((()=>S($.activeFilename)));for(const t in $.files)t!==x&&b($.files[t]);function z(t,e){$.activeFilename=t,$.activeFile.code=e}function P(t){$.activeFile.compiled.errors=t}async function F(t){if(t!==V.value)return[];const e=await A($.files[t]);["color: white","background: #42b983","margin-left: 4px","padding: 2px 4px","border-radius: 2px"].join(";");return e.reverse()}async function A(t,e=new Set){if(e.has(t))return[];e.add(t),await b(t);const{js:n,css:r}=t.compiled,s=new o.MagicString(n),a=o.babelParse(n,{sourceFilename:t.filename,sourceType:"module",plugins:[..._]}).program.body,i=new Map,l=new Set,c=new Set,d=new Map;function p(t,e){const n=e.replace(/^\.\/+/,"");if(!(n in $.files))throw new Error(`File "${n}" does not exist.`);if(c.has(n))return d.get(n);c.add(n);const r=`__import_${c.size}__`;return d.set(n,r),s.appendLeft(t.start,`const ${r} = __modules__[${JSON.stringify(n)}]\n`),r}function u(t,e=t){s.append(`\n__export__(__module__, "${t}", () => ${e})`)}s.prepend(`window.__modules__ = {}\nwindow.__css__ = ''\n\nconst __module__ = __modules__[${JSON.stringify(t.filename)}] = { [Symbol.toStringTag]: "Module" }\n\n`);for(const t of a)if("ImportDeclaration"===t.type){if(t.source.value.startsWith("./")){const e=p(t,t.source.value);for(const n of t.specifiers)"ImportSpecifier"===n.type?i.set(n.local.name,`${e}.${n.imported.name}`):"ImportDefaultSpecifier"===n.type?i.set(n.local.name,`${e}.default`):i.set(n.local.name,e);s.remove(t.start,t.end)}}for(const t of a){if("ExportNamedDeclaration"===t.type)if(t.declaration){if("FunctionDeclaration"===t.declaration.type||"ClassDeclaration"===t.declaration.type)u(t.declaration.id.name);else if("VariableDeclaration"===t.declaration.type)for(const e of t.declaration.declarations){const t=I(e.id).map((t=>t.name));for(const e of t)u(e)}s.remove(t.start,t.declaration.start)}else if(t.source){const e=p(t,t.source.value);for(const n of t.specifiers)u(n.exported.name,`${e}.${n.local.name}`);s.remove(t.start,t.end)}else{for(const e of t.specifiers){const t=e.local.name,n=i.get(t);u(e.exported.name,n||t)}s.remove(t.start,t.end)}if("ExportDefaultDeclaration"===t.type&&s.overwrite(t.start,t.start+14,"__module__.default ="),"ExportAllDeclaration"===t.type){const e=p(t,t.source.value);s.remove(t.start,t.end),s.append(`\nfor (const key in ${e}) {\n        if (key !== 'default') {\n          __export__(__module__, key, () => ${e}[key])\n        }\n      }`)}}for(const t of a)"ImportDeclaration"!==t.type&&o.walkIdentifiers(t,((t,e,n)=>{const r=i.get(t.name);if(r)if(B(e)&&e.shorthand)e.inPattern&&!D(e,n)||s.appendLeft(t.end,`: ${r}`);else if("ClassDeclaration"===e.type&&t===e.superClass){if(!l.has(t.name)){l.add(t.name);const e=n[1];s.prependRight(e.start,`const ${t.name} = ${r};\n`)}}else s.overwrite(t.start,t.end,r)}));o.walk(a,{enter(t,e){if("Import"===t.type&&"CallExpression"===e.type){const n=e.arguments[0];"StringLiteral"===n.type&&n.value.startsWith("./")&&(s.overwrite(t.start,t.start+6,"__dynamic_import__"),s.overwrite(n.start,n.end,JSON.stringify(n.value.replace(/^\.\/+/,""))))}}}),r&&s.append(`\nwindow.__css__ += ${JSON.stringify(r)}`);const f=[O.value,s.toString()];if(c.size)for(const t of c){const n=await A($.files[t],e);f.push(...n)}return f}const B=t=>"ObjectProperty"===t.type&&!t.computed;function I(t,e=[]){switch(t.type){case"Identifier":e.push(t);break;case"MemberExpression":let n=t;for(;"MemberExpression"===n.type;)n=n.object;e.push(n);break;case"ObjectPattern":t.properties.forEach((t=>{"RestElement"===t.type?I(t.argument,e):I(t.value,e)}));break;case"ArrayPattern":t.elements.forEach((t=>{t&&I(t,e)}));break;case"RestElement":I(t.argument,e);break;case"AssignmentPattern":I(t.left,e)}return e}function D(t,e){if(t&&("ObjectProperty"===t.type||"ArrayPattern"===t.type)){let t=e.length;for(;t--;){const n=e[t];if("AssignmentExpression"===n.type)return!0;if("ObjectProperty"!==n.type&&!n.type.endsWith("Pattern"))break}}return!1}const L=Symbol(),T=Symbol(),R=Symbol(),H=Symbol();e.pushScopeId("data-v-9f50ebd0");const W={class:"sfc-sandbox__editor"},J={class:"editor-header"},U={class:"editor-header__left"},q={class:"editor-container"};e.popScopeId();var Y=e.defineComponent({expose:[],props:{sfcFilename:{type:String,default:"App.vue"},sfcCode:{type:String,default:""}},setup(t){const n=t,r=e.inject(R),o=e.inject(H),s=p((async t=>{r.value=!0,o.value=[],function(t,e){if(!(t in $.files))return void P([`File "${t}" is not exists.`]);z($.files[t].filename,e)}(n.sfcFilename,t);const e=await F(n.sfcFilename);o.value=e,r.value=!1}),250),a=e.ref(n.sfcCode),i=e.computed((()=>n.sfcFilename.endsWith(".vue")?"htmlmixed":"javascript"));return e.watch((()=>a.value),(t=>s(t)),{immediate:!0}),e.onMounted((()=>{""!==n.sfcCode&&(!function(t,e){if(!t.endsWith(".vue")&&!t.endsWith(".js")&&"import-map.json"!==t)return void P(["Sandbox only supports *.vue, *.js files or import-map.json."]);if(t in $.files)return void P([`File "${t}" already exists.`]);const n=$.files[t]=new j(t);n.code="import-map.json"===t?C:e,z(t,n.code)}(n.sfcFilename,n.sfcCode),a.value=n.sfcCode)})),(n,r)=>(e.openBlock(),e.createBlock(e.Fragment,null,[e.createCommentVNode(" <FileSelector/> "),e.createVNode("div",W,[e.createVNode("header",J,[e.createVNode("div",U,e.toDisplayString(t.sfcFilename),1)]),e.createVNode("main",q,[e.createVNode(u,{modelValue:a.value,"onUpdate:modelValue":r[1]||(r[1]=t=>a.value=t),mode:e.unref(i)},null,8,["modelValue","mode"]),e.createCommentVNode(' <Message :err="fileErrors" /> ')])])],2112))}});d(".sfc-sandbox__editor[data-v-9f50ebd0]{height:100%}.sfc-sandbox__editor[data-v-9f50ebd0] .editor-header[data-v-9f50ebd0]{display:flex;height:40px;justify-content:space-between;align-items:center;background-color:#f0f4fc}.sfc-sandbox__editor[data-v-9f50ebd0] .editor-header[data-v-9f50ebd0] .editor-header__left[data-v-9f50ebd0]{padding:10px 12px;font-weight:500}.sfc-sandbox__editor[data-v-9f50ebd0] .editor-container[data-v-9f50ebd0]{height:calc(100% - 40px);overflow:hidden;position:relative}"),Y.__scopeId="data-v-9f50ebd0",Y.__file="packages/sandbox/SandboxEditor.vue";const K=e.withScopeId("data-v-7de6be8b");var X=e.defineComponent({expose:[],props:["err","warn"],setup(t){const n=t,r=e.ref(!1);function o(t){if("string"==typeof t)return t;{let e=t.message;const n=t.loc;return n&&n.start&&(e=`(${n.start.line}:${n.start.column}) `+e),e}}return e.watch((()=>[n.err,n.warn]),(()=>{r.value=!1})),(n,s)=>(e.openBlock(),e.createBlock(e.Transition,{name:"fade"},{default:K((()=>[r.value||!t.err&&!t.warn?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createBlock("pre",{key:0,class:["msg",t.err?"err":"warn"],onClick:s[1]||(s[1]=t=>r.value=!0)},"      "+e.toDisplayString(o(t.err||t.warn))+"\n    ",3))])),_:1}))}});d(".msg[data-v-7de6be8b]{position:absolute;bottom:0;left:8px;right:8px;z-index:10;padding:14px 20px;border:2px solid transparent;border-radius:6px;font-family:var(--font-code);white-space:pre-wrap;max-height:calc(100% - 50px);overflow-y:scroll}.msg.err[data-v-7de6be8b]{color:red;border-color:red;background-color:#ffd7d7}.msg.warn[data-v-7de6be8b]{--color:#695f1b;color:var(--color);border-color:var(--color);background-color:#f7f0cd}.fade-enter-active[data-v-7de6be8b],.fade-leave-active[data-v-7de6be8b]{transition:all .15s ease-out}.fade-enter-from[data-v-7de6be8b],.fade-leave-to[data-v-7de6be8b]{opacity:0;transform:translateY(10px)}"),X.__scopeId="data-v-7de6be8b",X.__file="packages/sandbox/Message.vue";let G=1;class Q{constructor(t,e){this.iframe=t,this.handlers=e,this.pending_cmds=new Map,this.handle_event=t=>this.handle_repl_message(t),window.addEventListener("message",this.handle_event,!1)}destroy(){window.removeEventListener("message",this.handle_event)}iframe_command(t,e){return new Promise(((n,r)=>{const o=G++;this.pending_cmds.set(o,{resolve:n,reject:r}),this.iframe.contentWindow.postMessage({action:t,cmd_id:o,args:e},"*")}))}handle_command_message(t){let e=t.action,n=t.cmd_id,r=this.pending_cmds.get(n);if(r){if(this.pending_cmds.delete(n),"cmd_error"===e){let{message:e,stack:n}=t,o=new Error(e);o.stack=n,r.reject(o)}"cmd_ok"===e&&r.resolve(t.args)}}handle_repl_message(t){if(t.source!==this.iframe.contentWindow)return;const{action:e,args:n}=t.data;switch(e){case"cmd_error":case"cmd_ok":return this.handle_command_message(t.data);case"fetch_progress":return this.handlers.on_fetch_progress(n.remaining);case"error":return this.handlers.on_error(t.data);case"unhandledrejection":return this.handlers.on_unhandled_rejection(t.data);case"console":return this.handlers.on_console(t.data);case"console_group":return this.handlers.on_console_group(t.data);case"console_group_collapsed":return this.handlers.on_console_group_collapsed(t.data);case"console_group_end":return this.handlers.on_console_group_end(t.data)}}evalESM(t,e){return this.iframe_command("evalESM",{script:t,uuid:e})}evalCDN(t,e){return this.iframe_command("evalCDN",{srcs:t,uuid:e})}handle_links(){return this.iframe_command("catch_clicks",{})}}const Z={class:"sfc-sandbox__preview"},tt=e.createVNode("header",{class:"preview-header"},[e.createVNode("div",{class:"preview-header__left"}," Preview ")],-1);var et=e.defineComponent({expose:[],props:{sfcFilename:{type:String,default:"App.vue"}},setup(t){const n=t,r=e.ref(),o=e.ref(),s=e.ref(),a=e.ref(btoa(Date.now().toString()));let i,l,c;const d=e.inject(L),p=e.inject(T),u=e.inject(R),f=e.inject(H),m=e.computed((()=>$.files[n.sfcFilename]?.compiled?.errors[0]));e.onMounted((function(){i&&(l.destroy(),c(),r.value.removeChild(i));i=document.createElement("iframe"),i.setAttribute("id",a.value),i.setAttribute("sandbox",["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts","allow-top-navigation-by-user-activation"].join(" "));const t=(()=>{const t=JSON.parse($.importMap||"{}");t.imports||(t.imports={});t.imports.vue="https://cdn.jsdelivr.net/npm/vue@next/dist/vue.runtime.esm-browser.js",d&&Object.keys(d).forEach((e=>{t.imports[e]||(t.imports[e]=d[e])}));return t})(),n="<!doctype html>\n<html>\n\t<head>\n\t\t<style>\n\t\t\tbody {\n\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n\t\t\t\t\tOxygen, Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", sans-serif;\n\t\t\t\tmargin: 0;\n\t\t\t}\n\t\t</style>\n\t\t<style id=\"__sfc-styles\"></style>\n\t\t<script>window.process = { env: {} }<\/script>\n\t\t<script>\n\t\t\t(() => {\n\t\t\t\tlet scriptEls = []\n\t\t\t\tlet cdnEls = []\n\n\t\t\t\twindow.__modules__ = {}\n\n\t\t\t\twindow.__export__ = (mod, key, get) => {\n\t\t\t\t\tObject.defineProperty(mod, key, {\n\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tget\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\twindow.__dynamic_import__ = key => {\n\t\t\t\t\treturn Promise.resolve(window.__modules__[key])\n\t\t\t\t}\n\n\t\t\t\tasync function handle_message(ev) {\n\t\t\t\t\tif (ev.srcElement.frameElement.id !== ev.data.args.uuid) return\n\t\t\t\t\tlet { action, cmd_id } = ev.data;\n\t\t\t\t\tconst send_message = (payload) => parent.postMessage( { ...payload }, ev.origin);\n\t\t\t\t\tconst send_reply = (payload) => send_message({ ...payload, cmd_id });\n\t\t\t\t\tconst send_ok = () => send_reply({ action: 'cmd_ok' });\n\t\t\t\t\tconst send_error = (message, stack) => send_reply({ action: 'cmd_error', message, stack });\n\n\t\t\t\t\tif (action === 'evalESM') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (scriptEls.length) {\n\t\t\t\t\t\t\t\tscriptEls.forEach(el => {\n\t\t\t\t\t\t\t\t\tdocument.head.removeChild(el)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tscriptEls.length = 0\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet { script: scripts } = ev.data.args\n\t\t\t\t\t\t\tif (typeof scripts === 'string') scripts = [scripts]\n\n\t\t\t\t\t\t\tfor (const script of scripts) {\n\t\t\t\t\t\t\t\t// console.log(script)\n\t\t\t\t\t\t\t\tconst scriptEl = document.createElement('script')\n\t\t\t\t\t\t\t\tscriptEl.setAttribute('type', 'module')\n\t\t\t\t\t\t\t\t// send ok in the module script to ensure sequential evaluation\n\t\t\t\t\t\t\t\t// of multiple proxy.eval() calls\n\t\t\t\t\t\t\t\tconst done = new Promise((resolve) => {\n\t\t\t\t\t\t\t\t\twindow.__next__ = resolve\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tscriptEl.innerHTML = script + `\\nwindow.__next__()`\n\t\t\t\t\t\t\t\tdocument.head.appendChild(scriptEl)\n\t\t\t\t\t\t\t\tscriptEl.onrror = err => send_error(err.message, err.stack)\n\t\t\t\t\t\t\t\tscriptEls.push(scriptEl)\n\t\t\t\t\t\t\t\tawait done\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twindow.__next__ = undefined\n\t\t\t\t\t\t\tsend_ok()\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tsend_error(e.message, e.stack);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (action === 'evalCDN') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (cdnEls.length) {\n\t\t\t\t\t\t\t\tcdnEls.forEach(el => {\n\t\t\t\t\t\t\t\t\tdocument.head.removeChild(el)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcdnEls.length = 0\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet { srcs } = ev.data.args\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (const src of srcs) {\n\t\t\t\t\t\t\t\tconst cdnEl = document.createElement('script')\n\t\t\t\t\t\t\t\tcdnEl.setAttribute('src', src)\n\t\t\t\t\t\t\t\tdocument.head.appendChild(cdnEl)\n\t\t\t\t\t\t\t\tcdnEls.onrror = err => send_error(err.message, err.stack)\n\t\t\t\t\t\t\t\tcdnEls.push(cdnEl)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsend_ok()\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tsend_error(e.message, e.stack)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (action === 'catch_clicks') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst top_origin = ev.origin;\n\t\t\t\t\t\t\tdocument.body.addEventListener('click', event => {\n\t\t\t\t\t\t\t\tif (event.which !== 1) return;\n\t\t\t\t\t\t\t\tif (event.metaKey || event.ctrlKey || event.shiftKey) return;\n\t\t\t\t\t\t\t\tif (event.defaultPrevented) return;\n\n\t\t\t\t\t\t\t\t// ensure target is a link\n\t\t\t\t\t\t\t\tlet el = event.target;\n\t\t\t\t\t\t\t\twhile (el && el.nodeName !== 'A') el = el.parentNode;\n\t\t\t\t\t\t\t\tif (!el || el.nodeName !== 'A') return;\n\n\t\t\t\t\t\t\t\tif (el.hasAttribute('download') || el.getAttribute('rel') === 'external' || el.target) return;\n\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t\t\tif (el.href.startsWith(top_origin)) {\n\t\t\t\t\t\t\t\t\tconst url = new URL(el.href);\n\t\t\t\t\t\t\t\t\tif (url.hash[0] === '#') {\n\t\t\t\t\t\t\t\t\t\twindow.location.hash = url.hash;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twindow.open(el.href, '_blank');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tsend_ok();\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tsend_error(e.message, e.stack);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\twindow.addEventListener('message', handle_message, false);\n\n\t\t\t\twindow.onerror = function (msg, url, lineNo, columnNo, error) {\n\t\t\t\t\tif (msg.includes('module specifier “vue”')) {\n\t\t\t\t\t\t// firefox only error, ignore\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tparent.postMessage({ action: 'error', value: error }, '*');\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tparent.postMessage({ action: 'error', value: msg }, '*');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\twindow.addEventListener(\"unhandledrejection\", event => {\n\t\t\t\t\tif (event.reason.message.includes('Cross-origin')) {\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tparent.postMessage({ action: 'unhandledrejection', value: event.reason }, '*');\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tparent.postMessage({ action: 'unhandledrejection', value: event.reason.message }, '*');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet previous = { level: null, args: null };\n\n\t\t\t\t['clear', 'log', 'info', 'dir', 'warn', 'error', 'table'].forEach((level) => {\n\t\t\t\t\tconst original = console[level];\n\t\t\t\t\tconsole[level] = (...args) => {\n\t\t\t\t\t\tconst msg = String(args[0])\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tmsg.includes('You are running a development build of Vue') ||\n\t\t\t\t\t\t\tmsg.includes('You are running the esm-bundler build of Vue')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst stringifiedArgs = stringify(args);\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tprevious.level === level &&\n\t\t\t\t\t\t\tprevious.args &&\n\t\t\t\t\t\t\tprevious.args === stringifiedArgs\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tparent.postMessage({ action: 'console', level, duplicate: true }, '*');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprevious = { level, args: stringifiedArgs };\n\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tparent.postMessage({ action: 'console', level, args }, '*');\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\tparent.postMessage({ action: 'console', level, args: args.map(a => {\n\t\t\t\t\t\t\t\t\treturn a instanceof Error ? a.message : String(a)\n\t\t\t\t\t\t\t\t}) }, '*');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toriginal(...args);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t[\n\t\t\t\t\t{ method: 'group', action: 'console_group' },\n\t\t\t\t\t{ method: 'groupEnd', action: 'console_group_end' },\n\t\t\t\t\t{ method: 'groupCollapsed', action: 'console_group_collapsed' },\n\t\t\t\t].forEach((group_action) => {\n\t\t\t\t\tconst original = console[group_action.method];\n\t\t\t\t\tconsole[group_action.method] = (label) => {\n\t\t\t\t\t\tparent.postMessage({ action: group_action.action, label }, '*');\n\n\t\t\t\t\t\toriginal(label);\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tconst timers = new Map();\n\t\t\t\tconst original_time = console.time;\n\t\t\t\tconst original_timelog = console.timeLog;\n\t\t\t\tconst original_timeend = console.timeEnd;\n\n\t\t\t\tconsole.time = (label = 'default') => {\n\t\t\t\t\toriginal_time(label);\n\t\t\t\t\ttimers.set(label, performance.now());\n\t\t\t\t}\n\t\t\t\tconsole.timeLog = (label = 'default') => {\n\t\t\t\t\toriginal_timelog(label);\n\t\t\t\t\tconst now = performance.now();\n\t\t\t\t\tif (timers.has(label)) {\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-log', args: [`${label}: ${now - timers.get(label)}ms`] }, '*');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-warn', args: [`Timer '${label}' does not exist`] }, '*');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.timeEnd = (label = 'default') => {\n\t\t\t\t\toriginal_timeend(label);\n\t\t\t\t\tconst now = performance.now();\n\t\t\t\t\tif (timers.has(label)) {\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-log', args: [`${label}: ${now - timers.get(label)}ms`] }, '*');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-warn', args: [`Timer '${label}' does not exist`] }, '*');\n\t\t\t\t\t}\n\t\t\t\t\ttimers.delete(label);\n\t\t\t\t};\n\n\t\t\t\tconst original_assert = console.assert;\n\t\t\t\tconsole.assert = (condition, ...args) => {\n\t\t\t\t\tif (condition) {\n\t\t\t\t\t\tconst stack = new Error().stack;\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'assert', args, stack }, '*');\n\t\t\t\t\t}\n\t\t\t\t\toriginal_assert(condition, ...args);\n\t\t\t\t};\n\n\t\t\t\tconst counter = new Map();\n\t\t\t\tconst original_count = console.count;\n\t\t\t\tconst original_countreset = console.countReset;\n\n\t\t\t\tconsole.count = (label = 'default') => {\n\t\t\t\t\tcounter.set(label, (counter.get(label) || 0) + 1);\n\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-log', args: `${label}: ${counter.get(label)}` }, '*');\n\t\t\t\t\toriginal_count(label);\n\t\t\t\t};\n\n\t\t\t\tconsole.countReset = (label = 'default') => {\n\t\t\t\t\tif (counter.has(label)) {\n\t\t\t\t\t\tcounter.set(label, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.postMessage({ action: 'console', level: 'system-warn', args: `Count for '${label}' does not exist` }, '*');\n\t\t\t\t\t}\n\t\t\t\t\toriginal_countreset(label);\n\t\t\t\t};\n\n\t\t\t\tconst original_trace = console.trace;\n\n\t\t\t\tconsole.trace = (...args) => {\n\t\t\t\t\tconst stack = new Error().stack;\n\t\t\t\t\tparent.postMessage({ action: 'console', level: 'trace', args, stack }, '*');\n\t\t\t\t\toriginal_trace(...args);\n\t\t\t\t};\n\n\t\t\t\tfunction stringify(args) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn JSON.stringify(args);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})()\n\t\t<\/script>\n\n\t\t\x3c!-- ES Module Shims: Import maps polyfill for modules browsers without import maps support (all except Chrome 89+) --\x3e\n\t\t<script async src=\"//cdn.jsdelivr.net/npm/es-module-shims@0.10.1/dist/es-module-shims.js\"><\/script>\n\t\t<script type=\"importmap\">\x3c!--IMPORT_MAP--\x3e<\/script>\n\t</head>\n\t<body>\n    <div id=\"app\"></div>\n  </body>\n</html>".replace(/<!--IMPORT_MAP-->/,JSON.stringify(t));i.srcdoc=n,r.value.appendChild(i),l=new Q(i,{on_fetch_progress:()=>{},on_error:t=>{const e=t.value instanceof Error?t.value.message:t.value;e.includes("Failed to resolve module specifier")||e.includes("Error resolving module specifier")?o.value=e.replace(/\. Relative references must.*$/,"")+".\nTip: specify import paths for dependencies in [imports-map] props on sandbox components":o.value=t.value},on_unhandled_rejection:t=>{let e=t.value;"string"==typeof e&&(e={message:e}),o.value="Uncaught (in promise): "+e.message},on_console:t=>{"error"===t.level?t.args[0]instanceof Error?o.value=t.args[0].message:o.value=t.args[0]:"warn"===t.level&&t.args[0].toString().includes("[Vue warn]")&&(s.value=t.args.join("").replace(/\[Vue warn\]:/,"").trim())},on_console_group:t=>{},on_console_group_end:()=>{},on_console_group_collapsed:t=>{}}),i.addEventListener("load",(()=>{l.handle_links(),c=e.watchEffect(g)}))})),e.onUnmounted((()=>{l.destroy(),c&&c()}));async function g(){o.value=null,s.value=null;try{u.value=!0;const t=e.toRaw(f.value);p&&p.length>0&&await l.evalCDN(p,a.value),t&&t.length>0&&await l.evalESM(t,a.value),u.value=!1}catch(t){u.value=!1,o.value=t.message}}return(t,n)=>(e.openBlock(),e.createBlock("div",Z,[tt,e.createVNode("main",{class:"preview-container",ref:r},null,512),e.createVNode(X,{err:o.value||e.unref(m)},null,8,["err"]),o.value?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createBlock(X,{key:0,warn:s.value},null,8,["warn"]))]))}});d(".sfc-sandbox__preview,iframe{width:100%;height:100%;border:none;background-color:#fff}.sfc-sandbox__preview .preview-header{display:flex;height:40px;justify-content:space-between;align-items:center;background-color:#f4f8fe}.sfc-sandbox__preview .preview-header .preview-header__left{padding:10px 12px;font-weight:500}.sfc-sandbox__preview .preview-container{width:100%;height:calc(100% - 40px);border:none;background-color:#fff}"),et.__file="packages/sandbox/SandboxPreview.vue";const nt={class:"sfc-sandbox__loading-mask"},rt=e.createVNode("div",{class:"loading-spinner"},[e.createVNode("svg",{class:"circular",viewBox:"25 25 50 50"},[e.createVNode("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none"})])],-1);d(".sfc-sandbox__loading-mask{position:absolute;z-index:2000;background-color:hsla(0,0%,100%,.9);margin:0;top:0;right:0;bottom:0;left:0;transition:opacity .3s}.sfc-sandbox__loading-mask .loading-spinner{top:50%;margin-top:-21px;width:100%;text-align:center;position:absolute}.sfc-sandbox__loading-mask .circular{width:42px;height:42px;-webkit-animation:loading-rotate 2s linear infinite;animation:loading-rotate 2s linear infinite}.sfc-sandbox__loading-mask .path{-webkit-animation:loading-dash 1.5s ease-in-out infinite;animation:loading-dash 1.5s ease-in-out infinite;stroke-dasharray:90,150;stroke-dashoffset:0;stroke-width:2;stroke:#5282e4;stroke-linecap:round}@-webkit-keyframes loading-rotate{to{transform:rotate(1turn)}}@keyframes loading-rotate{to{transform:rotate(1turn)}}@-webkit-keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}@keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}");const ot={render:function(t,n){return e.openBlock(),e.createBlock("div",nt,[rt])},__file:"packages/components/LoadingMask.vue"};var st=e.defineComponent({expose:[],props:{height:{type:Number,default:400},importMaps:{type:Object,default:()=>({})},externals:{type:Array,default:()=>[]},sfcFilename:{type:String,default:""},sfcCode:{type:String,default:""}},setup(t){const n=t,r=e.ref(!1),o=e.ref([]);e.provide(L,n.importMaps),e.provide(T,n.externals),e.provide(R,r),e.provide(H,o),e.watch(r,((t,e)=>{if(e){["color: white","background: #42b983","margin-left: 4px","padding: 2px 4px","border-radius: 2px"].join(";")}}));const s=e.computed((()=>({height:`${n.height}px`}))),a=t=>{};return(n,i)=>(e.openBlock(),e.createBlock(l,{class:"sfc-sandbox",style:e.unref(s),onResized:a},{left:e.withCtx((()=>[e.createVNode(Y,{"sfc-filename":t.sfcFilename,"sfc-code":t.sfcCode},null,8,["sfc-filename","sfc-code"])])),right:e.withCtx((()=>[e.createCommentVNode(' <Suspense>\n        <template #default v-if="esModules">\n          <sandbox-preview />\n        </template>\n        <template #fallback>\n          <loading-mask v-if="isLoadingPreview" />\n        </template>\n      </Suspense> '),e.withDirectives(e.createVNode(et,{"sfc-filename":t.sfcFilename},null,8,["sfc-filename"]),[[e.vShow,o.value]]),r.value?(e.openBlock(),e.createBlock(ot,{key:0})):e.createCommentVNode("v-if",!0)])),_:1},8,["style"]))}});d(".sfc-sandbox{box-sizing:content-box;border:1px solid #ebebeb;border-radius:2px;margin:20px;font-size:13px}.sfc-sandbox--editor,.sfc-sandbox--preview{width:50%}.sfc-sandbox--editor{border-right:1px dashed #ebebeb}.sfc-sandbox:hover{box-shadow:0 0 10px 0 rgba(232,237,250,.6),0 2px 4px 0 rgba(232,237,250,.6)}"),st.__file="packages/sandbox/index.vue";t.SfcSandbox=st,t.SplitPane=l,t.default=t=>{t.component("SfcSandbox",st),t.component("SplitPane",l),t.component("LoadingMask",ot)},Object.defineProperty(t,"__esModule",{value:!0})}));
